var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function l(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(e,n,o){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}function r(t,e){t.appendChild(e)}function i(t,e,n){t.insertBefore(e,n||null)}function u(t){t.parentNode.removeChild(t)}function f(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function a(t){return document.createElement(t)}function d(t){return document.createTextNode(t)}function h(){return d(" ")}function p(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function g(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function m(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function $(t,e){t.value=null==e?"":e}function y(t,e,n){t.classList[n?"add":"remove"](e)}let b;function v(t){b=t}const x=[],k=[],w=[],_=[],O=Promise.resolve();let j=!1;function S(t){w.push(t)}let B=!1;const E=new Set;function N(){if(!B){B=!0;do{for(let t=0;t<x.length;t+=1){const e=x[t];v(e),C(e.$$)}for(v(null),x.length=0;k.length;)k.pop()();for(let t=0;t<w.length;t+=1){const e=w[t];E.has(e)||(E.add(e),e())}w.length=0}while(x.length);for(;_.length;)_.pop()();j=!1,B=!1,E.clear()}}function C(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(S)}}const I=new Set;let z;function A(){z={r:0,c:[],p:z}}function L(){z.r||o(z.c),z=z.p}function J(t,e){t&&t.i&&(I.delete(t),t.i(e))}function F(t,e,n,o){if(t&&t.o){if(I.has(t))return;I.add(t),z.c.push((()=>{I.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}function T(t){t&&t.c()}function q(t,n,s){const{fragment:c,on_mount:r,on_destroy:i,after_update:u}=t.$$;c&&c.m(n,s),S((()=>{const n=r.map(e).filter(l);i?i.push(...n):o(n),t.$$.on_mount=[]})),u.forEach(S)}function D(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function M(t,e){-1===t.$$.dirty[0]&&(x.push(t),j||(j=!0,O.then(N)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function H(e,l,s,c,r,i,f=[-1]){const a=b;v(e);const d=l.props||{},h=e.$$={fragment:null,ctx:null,props:i,update:t,not_equal:r,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(a?a.$$.context:[]),callbacks:n(),dirty:f,skip_bound:!1};let p=!1;if(h.ctx=s?s(e,d,((t,n,...o)=>{const l=o.length?o[0]:n;return h.ctx&&r(h.ctx[t],h.ctx[t]=l)&&(!h.skip_bound&&h.bound[t]&&h.bound[t](l),p&&M(e,t)),n})):[],h.update(),p=!0,o(h.before_update),h.fragment=!!c&&c(h.ctx),l.target){if(l.hydrate){const t=function(t){return Array.from(t.childNodes)}(l.target);h.fragment&&h.fragment.l(t),t.forEach(u)}else h.fragment&&h.fragment.c();l.intro&&J(e.$$.fragment),q(e,l.target,l.anchor),N()}v(a)}class P{$destroy(){D(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function U(t){let e,n,o=t[0].code+"";return{c(){e=a("code"),n=d(o),g(e,"class","svelte-1h0g1l5")},m(t,o){i(t,e,o),r(e,n)},p(t,e){1&e&&o!==(o=t[0].code+"")&&m(n,o)},d(t){t&&u(e)}}}function W(e){let n,o,l,s,c,f,p,$,y,b=e[0].time.toISOString()+"",v=e[0].text+"",x=e[0].code&&U(e);return{c(){n=a("div"),o=a("div"),l=d(b),s=h(),c=a("div"),f=a("div"),p=d(v),$=h(),x&&x.c(),g(o,"class","time"),g(f,"class","text"),g(c,"class","body"),g(n,"class",y="container "+e[0].type+" svelte-1h0g1l5")},m(t,e){i(t,n,e),r(n,o),r(o,l),r(n,s),r(n,c),r(c,f),r(f,p),r(c,$),x&&x.m(c,null)},p(t,[e]){1&e&&b!==(b=t[0].time.toISOString()+"")&&m(l,b),1&e&&v!==(v=t[0].text+"")&&m(p,v),t[0].code?x?x.p(t,e):(x=U(t),x.c(),x.m(c,null)):x&&(x.d(1),x=null),1&e&&y!==(y="container "+t[0].type+" svelte-1h0g1l5")&&g(n,"class",y)},i:t,o:t,d(t){t&&u(n),x&&x.d()}}}function Y(t,e,n){let{message:o}=e;return t.$$set=t=>{"message"in t&&n(0,o=t.message)},[o]}class G extends P{constructor(t){super(),H(this,t,Y,W,s,{message:0})}}const K=[];function Q(e,n=t){let o;const l=[];function c(t){if(s(e,t)&&(e=t,o)){const t=!K.length;for(let t=0;t<l.length;t+=1){const n=l[t];n[1](),K.push(n,e)}if(t){for(let t=0;t<K.length;t+=2)K[t][0](K[t+1]);K.length=0}}}return{set:c,update:function(t){c(t(e))},subscribe:function(s,r=t){const i=[s,r];return l.push(i),1===l.length&&(o=n(c)||t),s(e),()=>{const t=l.indexOf(i);-1!==t&&l.splice(t,1),0===l.length&&(o(),o=null)}}}}function R(t){V.update((e=>(e.push({text:t,time:new Date,type:"msg"}),e)))}const V=Q([]),X=Q(void 0),Z={"set-client-id":t=>{tt.id=t.data.clientId,R("You are client "+t.data.clientId)},debug:t=>R("debug "+t.data.message),chat:t=>R(`${t.data.client} says ${t.data.text}`),state:t=>X.set(t.data)};const tt=new class{constructor(){this.id=-1}send(t){this.ws.send(JSON.stringify(t))}connect(t){this.ws=new WebSocket(t),this.ws.addEventListener("message",(t=>{const e=JSON.parse(t.data);Z[e.type]?Z[e.type](e):function(t,e){V.update((n=>(n.push({text:t,time:new Date,type:"warning",code:null==e?void 0:e.code}),n)))}("Unsupported message",{code:JSON.stringify(e,void 0,2)})}))}};function et(t,e,n){const o=t.slice();return o[4]=e[n],o}function nt(t){let e,n;return e=new G({props:{message:t[4]}}),{c(){T(e.$$.fragment)},m(t,o){q(e,t,o),n=!0},p(t,n){const o={};2&n&&(o.message=t[4]),e.$set(o)},i(t){n||(J(e.$$.fragment,t),n=!0)},o(t){F(e.$$.fragment,t),n=!1},d(t){D(e,t)}}}function ot(t){let e,n,l,s,c,d,m,y,b=t[1],v=[];for(let e=0;e<b.length;e+=1)v[e]=nt(et(t,b,e));const x=t=>F(v[t],1,1,(()=>{v[t]=null}));return{c(){e=a("div"),n=a("div");for(let t=0;t<v.length;t+=1)v[t].c();l=h(),s=a("div"),c=a("input"),g(n,"class","log svelte-1e563j7"),g(c,"type","text"),g(c,"placeholder","Here you can write your chat-message"),g(c,"class","svelte-1e563j7"),g(s,"class","chat-input svelte-1e563j7"),g(e,"class","container svelte-1e563j7")},m(o,u){i(o,e,u),r(e,n);for(let t=0;t<v.length;t+=1)v[t].m(n,null);r(e,l),r(e,s),r(s,c),$(c,t[0]),d=!0,m||(y=[p(c,"input",t[3]),p(c,"keyup",t[2])],m=!0)},p(t,[e]){if(2&e){let o;for(b=t[1],o=0;o<b.length;o+=1){const l=et(t,b,o);v[o]?(v[o].p(l,e),J(v[o],1)):(v[o]=nt(l),v[o].c(),J(v[o],1),v[o].m(n,null))}for(A(),o=b.length;o<v.length;o+=1)x(o);L()}1&e&&c.value!==t[0]&&$(c,t[0])},i(t){if(!d){for(let t=0;t<b.length;t+=1)J(v[t]);d=!0}},o(t){v=v.filter(Boolean);for(let t=0;t<v.length;t+=1)F(v[t]);d=!1},d(t){t&&u(e),f(v,t),m=!1,o(y)}}}function lt(t,e,n){let o;c(t,V,(t=>n(1,o=t)));let l="";return[l,o,function(t){"Enter"===t.key&&0!=l.length&&(tt.send({type:"chat",text:l.trim()}),n(0,l=""))},function(){l=this.value,n(0,l)}]}class st extends P{constructor(t){super(),H(this,t,lt,ot,s,{})}}function ct(e){let n,o,l;return{c(){n=a("button"),n.textContent="ðŸ”’",g(n,"class","svelte-dybbjl")},m(t,s){i(t,n,s),o||(l=p(n,"click",e[11]),o=!0)},p:t,d(t){t&&u(n),o=!1,l()}}}function rt(e){let n,o,l;return{c(){n=a("button"),n.textContent="ðŸ”‘",g(n,"class","svelte-dybbjl")},m(t,s){i(t,n,s),o||(l=p(n,"click",e[12]),o=!0)},p:t,d(t){t&&u(n),o=!1,l()}}}function it(e){let n,l,s,c,f,m,b,v,x;function k(t,e){return t[2]?rt:ct}let w=k(e),_=w(e);return{c(){n=a("input"),s=h(),_.c(),c=h(),f=a("button"),m=d("ðŸ’”"),n.disabled=l=!e[3],g(n,"title",e[6]),g(n,"class","svelte-dybbjl"),y(n,"noAutoLock",!e[4]),y(n,"lockedByOthers",e[5]),y(n,"isFrozen",e[1]),g(f,"title","break lock"),f.disabled=b=!e[5],g(f,"class","svelte-dybbjl")},m(t,o){i(t,n,o),e[16](n),$(n,e[0]),i(t,s,o),_.m(t,o),i(t,c,o),i(t,f,o),r(f,m),v||(x=[p(n,"input",e[17]),p(n,"focus",e[9]),p(n,"blur",e[10]),p(n,"dblclick",e[8]),p(f,"click",e[13])],v=!0)},p(t,[e]){8&e&&l!==(l=!t[3])&&(n.disabled=l),64&e&&g(n,"title",t[6]),1&e&&n.value!==t[0]&&$(n,t[0]),16&e&&y(n,"noAutoLock",!t[4]),32&e&&y(n,"lockedByOthers",t[5]),2&e&&y(n,"isFrozen",t[1]),w===(w=k(t))&&_?_.p(t,e):(_.d(1),_=w(t),_&&(_.c(),_.m(c.parentNode,c))),32&e&&b!==(b=!t[5])&&(f.disabled=b)},i:t,o:t,d(t){t&&u(n),e[16](null),t&&u(s),_.d(t),t&&u(c),t&&u(f),v=!1,o(x)}}}function ut(t,e,n){let o;c(t,X,(t=>n(19,o=t)));let{x:l}=e,{y:s}=e;var r,i=0,u=!1,f=!1,a=!0,d=!0,h=!1,p="",g=void 0;return t.$$set=t=>{"x"in t&&n(14,l=t.x),"y"in t&&n(15,s=t.y)},t.$$.update=()=>{if(835618&t.$$.dirty){const t=o;if(JSON.stringify(t)!==JSON.stringify(g)){const e=t.fields[s*t.width+l];n(0,i=e.value),n(1,u=(e.frozenByClientIds||[]).length>0),n(2,f=(e.frozenByClientIds||[]).some((t=>t==tt.id))),n(5,h="number"==typeof e.lockedByClientId&&e.lockedByClientId!==tt.id),n(3,a=!h&&!u)}h&&n(6,p="Field is locked by others"),u&&n(6,p="Field is frozen"),n(18,g=t)}},[i,u,f,a,d,h,p,r,function(){n(4,d=!d)},function(){d&&tt.send({type:"lock",x:l,y:s})},function(){tt.send({type:"set-value",x:l,y:s,value:i}),d&&tt.send({type:"unlock",x:l,y:s})},function(){tt.send({type:"freeze",x:l,y:s})},function(){tt.send({type:"unfreeze",x:l,y:s})},function(){h&&confirm("This field is locked by another client, do you want to steal the lock?")&&(tt.send({type:"steal-lock",x:l,y:s}),n(3,a=!0),queueMicrotask((()=>{r.focus(),r.select()})))},l,s,function(t){k[t?"unshift":"push"]((()=>{n(7,r=t)}))},function(){i=this.value,n(0,i),n(19,o),n(18,g),n(15,s),n(14,l),n(5,h),n(1,u)}]}class ft extends P{constructor(t){super(),H(this,t,ut,it,s,{x:14,y:15})}}function at(t,e,n){const o=t.slice();return o[9]=e[n],o[11]=n,o}function dt(t,e,n){const o=t.slice();return o[6]=e[n],o[8]=n,o}function ht(e){let n,o;return n=new ft({props:{x:e[11],y:e[8]}}),{c(){T(n.$$.fragment)},m(t,e){q(n,t,e),o=!0},p:t,i(t){o||(J(n.$$.fragment,t),o=!0)},o(t){F(n.$$.fragment,t),o=!1},d(t){D(n,t)}}}function pt(t){let e,n,o,l=t[6],s=[];for(let e=0;e<l.length;e+=1)s[e]=ht(at(t,l,e));const c=t=>F(s[t],1,1,(()=>{s[t]=null}));return{c(){e=a("tr");for(let t=0;t<s.length;t+=1)s[t].c();n=h()},m(t,l){i(t,e,l);for(let t=0;t<s.length;t+=1)s[t].m(e,null);r(e,n),o=!0},p(t,o){if(1&o){let r;for(l=t[6],r=0;r<l.length;r+=1){const c=at(t,l,r);s[r]?(s[r].p(c,o),J(s[r],1)):(s[r]=ht(c),s[r].c(),J(s[r],1),s[r].m(e,n))}for(A(),r=l.length;r<s.length;r+=1)c(r);L()}},i(t){if(!o){for(let t=0;t<l.length;t+=1)J(s[t]);o=!0}},o(t){s=s.filter(Boolean);for(let t=0;t<s.length;t+=1)F(s[t]);o=!1},d(t){t&&u(e),f(s,t)}}}function gt(t){let e,n,o=t[0],l=[];for(let e=0;e<o.length;e+=1)l[e]=pt(dt(t,o,e));const s=t=>F(l[t],1,1,(()=>{l[t]=null}));return{c(){e=a("table");for(let t=0;t<l.length;t+=1)l[t].c()},m(t,o){i(t,e,o);for(let t=0;t<l.length;t+=1)l[t].m(e,null);n=!0},p(t,[n]){if(1&n){let c;for(o=t[0],c=0;c<o.length;c+=1){const s=dt(t,o,c);l[c]?(l[c].p(s,n),J(l[c],1)):(l[c]=pt(s),l[c].c(),J(l[c],1),l[c].m(e,null))}for(A(),c=o.length;c<l.length;c+=1)s(c);L()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)J(l[t]);n=!0}},o(t){l=l.filter(Boolean);for(let t=0;t<l.length;t+=1)F(l[t]);n=!1},d(t){t&&u(e),f(l,t)}}}function mt(t,e,n){let o;c(t,X,(t=>n(3,o=t)));let l=[[]];return t.$$.update=()=>{if(14&t.$$.dirty){var e=o;if(e){for(var s=[],c=0;c<e.height;n(1,++c)){s.push([]);for(var r=0;r<e.width;n(2,++r))s[c].push(e.fields[c*e.width+r])}n(0,l=s)}}},[l]}class $t extends P{constructor(t){super(),H(this,t,mt,gt,s,{})}}function yt(e){let n,o,l,s,c,f,d;return l=new st({}),f=new $t({}),{c(){n=a("div"),o=a("div"),T(l.$$.fragment),s=h(),c=a("div"),T(f.$$.fragment),g(o,"class","left"),g(c,"class","right"),g(n,"class","container svelte-13j6rna")},m(t,e){i(t,n,e),r(n,o),q(l,o,null),r(n,s),r(n,c),q(f,c,null),d=!0},p:t,i(t){d||(J(l.$$.fragment,t),J(f.$$.fragment,t),d=!0)},o(t){F(l.$$.fragment,t),F(f.$$.fragment,t),d=!1},d(t){t&&u(n),D(l),D(f)}}}const bt=new class extends P{constructor(t){super(),H(this,t,null,yt,s,{})}}({target:document.body});return tt.connect("ws://localhost:3000"),bt}();
//# sourceMappingURL=bundle.js.map
